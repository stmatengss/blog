<!doctype html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/blog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/blog/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/blog/favicon.ico?v=5.1.1" />






<meta name="description" content="...">
<meta property="og:type" content="website">
<meta property="og:title" content="Teng&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/blog/page/4/index.html">
<meta property="og:site_name" content="Teng&#39;s Blog">
<meta property="og:description" content="...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Teng&#39;s Blog">
<meta name="twitter:description" content="...">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/blog/page/4/"/>





  <title>Teng's Blog</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-116728507-1', 'auto');
  ga('send', 'pageview');
</script>











</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/blog/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Teng's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">A coder and systemer</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/blog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/blog/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/blog/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/blog/blog/2017/10/05/How-to-Build-a-Non-Volatile-Memory-DBMS-Survey/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Teng Ma">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Teng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/10/05/How-to-Build-a-Non-Volatile-Memory-DBMS-Survey/" itemprop="url">How to Build a Non-Volatile Memory DBMS (Survey)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-05T11:13:48+08:00">
                2017-10-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>This is a summary about a <a href="https://www.cs.cmu.edu/~jarulraj/papers/2017.nvm.sigmod.pdf" target="_blank" rel="external">paper</a> and a related <a href="https://www.cs.cmu.edu/~jarulraj/talks/2017.nvm.sigmod.pdf" target="_blank" rel="external">talk</a> in <code>Sigmod 17</code>, and this paper concludes the three main ways to make use of the special features in NVM when build up a DBMS.</p>
<hr>
<h2 id="NVM-properties"><a href="#NVM-properties" class="headerlink" title="NVM properties:"></a>NVM properties:</h2><ul>
<li><ol>
<li>Byte addressable: Loads and stores un`like SSD/HDD</li>
<li>High random write throughput: Orders of magnitude higher than SSD/HDD, Smaller gap between sequential &amp; random write throughput.</li>
<li>Read-write asymmetry &amp; wear-leveling: Writes might take longer to complete compared to reads. Excessive writes to a single NVM cell can destroy it.</li>
</ol>
</li>
</ul>
<h2 id="Evaluation-NVM"><a href="#Evaluation-NVM" class="headerlink" title="Evaluation NVM"></a>Evaluation NVM</h2><ul>
<li>=&gt; HDD/SSD/Emulated NVM.<ul>
<li>Tune DRAM latency to emulate NVM (increasing latency)</li>
<li>CLWB (Cache-line write back) instruction</li>
</ul>
</li>
</ul>
<h1 id="Three-levels-in-NVM-DBMS"><a href="#Three-levels-in-NVM-DBMS" class="headerlink" title="Three levels in NVM DBMS:"></a>Three levels in NVM DBMS:</h1><p>1) Access Interfaces,<br>2) Storage Manager<br>3) Execution Engine.</p>
<h2 id="Allocation-interface"><a href="#Allocation-interface" class="headerlink" title="Allocation interface"></a>Allocation interface</h2><ul>
<li><p>Standard functions</p>
<ul>
<li>Dynamic memory allocation</li>
<li>Meta-data management</li>
</ul>
<ul>
<li>Durability mechanism<ul>
<li>Two-step implementation<ul>
<li>Allocation first by using CLWB</li>
<li>Issues a SFENCE to make sure changes are visible</li>
</ul>
</li>
</ul>
</li>
<li>Naming mechanism<ul>
<li>Map NVM to a well know base address, <code>Absolute pointer = Base address + Relative pointer</code></li>
</ul>
</li>
<li>Recovery mechanism<ul>
<li>Consider a crashing before linking the chunk to DS which occur to losing of this chunk (neither allocator nor application can reclaim the space).</li>
</ul>
</li>
</ul>
</li>
<li><p>File system interface</p>
<ul>
<li>Device -&gt; page cache -&gt; app buffer =&gt; Device -&gt; app buffer </li>
<li>64 bytes cache line atomic</li>
</ul>
</li>
</ul>
<h2 id="Storage-Manager"><a href="#Storage-Manager" class="headerlink" title="Storage Manager"></a>Storage Manager</h2><ul>
<li>Logging &amp; Recovery<ul>
<li>Write ahead log (<code>LET’S TALK ABOUT STORAGE AND RECOVERY METHODS FOR NON-VOLATILE MEMORY DATABASE SYSTEMS SIGMOD&#39; 2015</code>)<ul>
<li>Avoid duplicating data in the log and the checkpoint<ul>
<li>logging the meta-data not the data updates</li>
<li><code>WAL + FS API</code> vs. <code>WA(meta-data)L + Allocation API</code> </li>
</ul>
</li>
</ul>
</li>
<li>Write behind log (<code>WRITE-BEHIND LOGGING VLDB&#39; 17</code>)<ul>
<li>pros<ol>
<li>Write-behind logging enables instant recovery</li>
<li>Improves device utilization by reducing data duplication</li>
<li>Extends the device lifetime </li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
<li>Data placement<ul>
<li>Three-tiers: DRAM (meta-data + data) + NVM (log + data) + SSD (data)</li>
<li>DRAM -&gt; hot data (cache), NVM -&gt; warm data, SSD -&gt; cold data</li>
</ul>
</li>
</ul>
<h2 id="Access-Methods"><a href="#Access-Methods" class="headerlink" title="Access Methods"></a>Access Methods</h2><ul>
<li>Read-write asymmetry &amp; wear-leveling<br>  – Writes might take longer to complete compared to reads<br>  – Excessive writes to a single NVM cell can destroy it</li>
<li>Write-limited access methods<ul>
<li>NVM-aware B+Tree, hash table<ul>
<li>NVM-aware B+Tree: <ul>
<li>In leaf node, using linear scan (unsorted data) with fewer writes instead of binary search (sorted data) with more writes.</li>
<li>Using unbalanced tree (fewer writes)</li>
</ul>
</li>
<li></li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="Execution-engine"><a href="#Execution-engine" class="headerlink" title="Execution engine"></a>Execution engine</h1><ul>
<li>Plan executor<ul>
<li>reduce the number of writes (Sorting algorithm and join algorithm) by using 1) adjustment of write-intensivity knob and 2) write-limited algorithms.<ul>
<li>Hybrid join/sort</li>
<li>Segment sort =&gt; adjust x (x% merge sort + (1-x)% selection sort)</li>
</ul>
</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/blog/blog/2017/10/05/How-to-Build-a-Non-Volatile-Memory/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Teng Ma">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Teng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/10/05/How-to-Build-a-Non-Volatile-Memory/" itemprop="url">How to Build a Non-Volatile Memory</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-05T11:12:43+08:00">
                2017-10-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/blog/blog/2017/09/27/A-Try-about-Profiling-Jemalloc-Code/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Teng Ma">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Teng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/09/27/A-Try-about-Profiling-Jemalloc-Code/" itemprop="url">A Try about Profiling Jemalloc Code</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-27T00:33:20+08:00">
                2017-09-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="A-Short-Introduction"><a href="#A-Short-Introduction" class="headerlink" title="A Short Introduction"></a>A Short Introduction</h1><p>Jemalloc is traditional implementation about allocation in OS, jemalloc first came into use as the FreeBSD <code>libc</code> allocator in 2005, and since then it has found its way into numerous applications that rely on its predictable behavior. Jemalloc has already used in thousands of real world applications to accelerate and strength allocation function. Jemalloc performs more efficient than <code>glibc malloc</code> (a.k.a, Ptmalloc) in a multi-thread situation, and has a higher scalability.</p>
<h1 id="API"><a href="#API" class="headerlink" title="API"></a>API</h1><ul>
<li>POSIX API</li>
</ul>
<p>jemalloc provides some common functions to allocation or deallocation memory in system, including <code>malloc, calloc, realloc, free, memalign and aligned_alloc</code>.</p>
<ul>
<li>NONE Standard API<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">void *mallocx(	size_t size,</div><div class="line"> 	int flags);</div><div class="line"> </div><div class="line">void *rallocx(	void *ptr,</div><div class="line"> 	size_t size,</div><div class="line"> 	int flags);</div><div class="line"> </div><div class="line">size_t xallocx(	void *ptr,</div><div class="line"> 	size_t size,</div><div class="line"> 	size_t extra,</div><div class="line"> 	int flags);</div><div class="line"> </div><div class="line">size_t sallocx(	void *ptr,</div><div class="line"> 	int flags);</div><div class="line"> </div><div class="line">void dallocx(	void *ptr,</div><div class="line"> 	int flags);</div><div class="line"> </div><div class="line">void sdallocx(	void *ptr,</div><div class="line"> 	size_t size,</div><div class="line"> 	int flags);</div><div class="line"> </div><div class="line">size_t nallocx(	size_t size,</div><div class="line"> 	int flags);</div><div class="line"> </div><div class="line">int mallctl(	const char *name,</div><div class="line"> 	void *oldp,</div><div class="line"> 	size_t *oldlenp,</div><div class="line"> 	void *newp,</div><div class="line"> 	size_t newlen);    // This one provides controlling of allocation configurations</div><div class="line"> </div><div class="line">int mallctlnametomib(	const char *name,</div><div class="line"> 	size_t *mibp,</div><div class="line"> 	size_t *miblenp);</div><div class="line"> </div><div class="line">int mallctlbymib(	const size_t *mib,</div><div class="line"> 	size_t miblen,</div><div class="line"> 	void *oldp,</div><div class="line"> 	size_t *oldlenp,</div><div class="line"> 	void *newp,</div><div class="line"> 	size_t newlen);</div><div class="line"> </div><div class="line">void malloc_stats_print(	void (*write_cb) (void *, const char *) ,</div><div class="line"> 	void *cbopaque,</div><div class="line"> 	const char *opts);  // For debuging code</div><div class="line"> </div><div class="line">size_t malloc_usable_size(	const void *ptr);</div><div class="line"> </div><div class="line">void (*malloc_message)(	void *cbopaque,</div><div class="line"> 	const char *s);</div></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="Compiling"><a href="#Compiling" class="headerlink" title="Compiling"></a>Compiling</h1><ul>
<li>You can use several ways to build up your jemalloc library, please refer to <a href="https://github.com/jemalloc/jemalloc/wiki/Getting-Started" target="_blank" rel="external">this</a> link for more details</li>
<li>My procedures for integrating jemalloc into an application:<ol>
<li>use <code>jemalloc-config</code> script in <code>bin</code> directory to looking your building root directory</li>
<li>Run <code>./configure</code> and run the <code>make</code> in bash</li>
<li>use <code>LD_PRELOAD</code> environment variable to add libjemalloc to LD environment</li>
<li>compiling the execution code like this <code>cc ex_stats_print.c -o ex_stats_print -I</code>jemalloc-config –includedir<code>-L</code>jemalloc-config –libdir<code>-Wl,-rpath,</code>jemalloc-config –libdir -ljemalloc <code>jemalloc-config --libs</code></li>
</ol>
</li>
<li>If you want change some details and use some surprise functions in jemalloc library:<ol>
<li>You can use <code>MALLOC_CONF</code> environment variable to control/tune jemalloc, like this <code>export MALLOC_CONF=&quot;prof:true,lg_prof_sample:1,prof_accum:false,prof_prefix:jeprof.out&quot;</code>, and there is <a href="http://jemalloc.net/jemalloc.3.html#tuning" target="_blank" rel="external">link</a> about how to use this options</li>
<li>Or you can change these configuration before making jemalloc project, these configuration options are enabled in libcs built-in jemalloc: <code>--enable-dss, --enable-experimental, --enable-fill, --enable-lazy-lock, --enable-munmap, --enable-stats, --enable-tcache, --enable-tls, --enable-utrace, and --enable-xmalloc</code>.</li>
<li><strong>Attention</strong> , Using <code>--with-jemalloc-prefix</code> as a option when compiling jemalloc with an API prefix, will make this library is not easy to use. You should use <code>je_XXX</code> to replace <code>XXX</code> function, and reconstruct the whole program.  </li>
</ol>
</li>
</ul>
<h1 id="Implementation-Details"><a href="#Implementation-Details" class="headerlink" title="Implementation Details"></a>Implementation Details</h1><ul>
<li><p>How Jemalloc get memory from OS?</p>
<ul>
<li>Jemlloc use <code>mmap</code> or <code>sbrk</code> to try to get memory from the lower level API. However, user can use the different strategy to control memory obtaining from <code>mmap</code>, <code>sbrk</code> or both of them.</li>
<li>Traditionally, allocators have used sbrk(2) to obtain memory, which is suboptimal for several reasons, including race conditions, increased fragmentation, and artificial limitations on maximum usable memory. If sbrk(2) is supported by the operating system, this allocator uses both mmap(2) and sbrk(2), in that order of preference; otherwise only mmap(2) is used.</li>
</ul>
</li>
<li><p>Small size allocation and large size allocation</p>
</li>
<li><p>Other details</p>
</li>
</ul>
<p>This allocator uses multiple arenas in order to reduce lock contention for threaded programs on multi-processor systems. This works well with regard to threading scalability, but incurs some costs. There is a small fixed per-arena overhead, and additionally, arenas manage memory completely independently of each other, which means a small fixed increase in overall memory fragmentation. These overheads are not generally an issue, given the number of arenas normally used. Note that using substantially more arenas than the default is not likely to improve performance, mainly due to reduced cache performance. However, it may make sense to reduce the number of arenas if an application does not make much use of the allocation functions.</p>
<p>In addition to multiple arenas, this allocator supports thread-specific caching, in order to make it possible to completely avoid synchronization for most allocation requests. Such caching allows very fast allocation in the common case, but it increases memory usage and fragmentation, since a bounded number of objects can remain allocated in each thread cache.</p>
<p>Memory is conceptually broken into extents. Extents are always aligned to multiples of the page size. This alignment makes it possible to find metadata for user objects quickly. User objects are broken into two categories according to size: small and large. Contiguous small objects comprise a slab, which resides within a single extent, whereas large objects each have their own extents backing them.</p>
<p>Small objects are managed in groups by slabs. Each slab maintains a bitmap to track which regions are in use. Allocation requests that are no more than half the quantum (8 or 16, depending on architecture) are rounded up to the nearest power of two that is at least sizeof(double). All other object size classes are multiples of the quantum, spaced such that there are four size classes for each doubling in size, which limits internal fragmentation to approximately 20% for all but the smallest size classes. Small size classes are smaller than four times the page size, and large size classes extend from four times the page size up to the largest size class that does not exceed PTRDIFF_MAX.</p>
<p>Allocations are packed tightly together, which can be an issue for multi-threaded applications. If you need to assure that allocations do not suffer from cacheline sharing, round your allocation requests up to the nearest multiple of the cacheline size, or specify cacheline alignment when allocating.</p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul>
<li><a href="http://jemalloc.net/" target="_blank" rel="external">Jemalloc official website</a></li>
<li><a href="https://github.com/jemalloc/jemalloc" target="_blank" rel="external">Jemalloc in Github</a></li>
<li><a href="http://www.gsp.com/cgi-bin/man.cgi?topic=malloc.conf" target="_blank" rel="external">FreeBSD man page about Jemalloc</a></li>
<li><a href="http://web.eecs.utk.edu/~huangj/cs360/360/notes/Malloc1/lecture.html" target="_blank" rel="external">Malloc Lab</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/blog/blog/2017/09/18/Paper-Reading-Allocation-of-NVRAM/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Teng Ma">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Teng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/09/18/Paper-Reading-Allocation-of-NVRAM/" itemprop="url">Paper Reading (Allocation of NVRAM)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-18T11:25:27+08:00">
                2017-09-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Introduction-about-NVRAM"><a href="#Introduction-about-NVRAM" class="headerlink" title="Introduction about NVRAM"></a>Introduction about NVRAM</h1><ul>
<li>Non-volatile <strong>byte-adressable</strong> memory </li>
<li><strong>Faster</strong> and more durable than flash</li>
<li>Higher <strong>capacity</strong>, cheaper, and less energy consumption than DRAM</li>
<li>Comparison between different kinds of storage medium.</li>
</ul>
<table>
<thead>
<tr>
<th>Types</th>
<th>Latency</th>
</tr>
</thead>
<tbody>
<tr>
<td>DRAM</td>
<td>0.01us</td>
</tr>
<tr>
<td>NVRAM</td>
<td>0.05~0.1us</td>
</tr>
<tr>
<td>Flash</td>
<td>100us</td>
</tr>
<tr>
<td>Disk</td>
<td>10000us</td>
</tr>
</tbody>
</table>
<h1 id="NVRAM-and-DRAM-hybrid-memory-system"><a href="#NVRAM-and-DRAM-hybrid-memory-system" class="headerlink" title="NVRAM and DRAM hybrid memory system"></a>NVRAM and DRAM hybrid memory system</h1><ul>
<li>Combine advantages of NVRAM and DRAM</li>
<li>Using DRAM as Cache to accelerate memory access</li>
<li>Using NVRAM to persistent data</li>
</ul>
<h1 id="Some-challenges-about-using-NVM"><a href="#Some-challenges-about-using-NVM" class="headerlink" title="Some challenges about using NVM"></a>Some challenges about using NVM</h1><ul>
<li>NVRAM may have inconsistent states if stores are reordered<ul>
<li>Compiler-Level Reordering, CPU Out-Of-Order Execution</li>
</ul>
</li>
<li>Volatile CPU caches hold data that is not on NVRAM</li>
<li>Incomplete updates need to be rolled back (restoring/recovering)</li>
<li>NVRAM memory has to be dynamically managed (reducing writes)</li>
<li>Pointers to NVRAM objects need to be valid after a restart (How to recover meta-data of allocation)</li>
</ul>
<h1 id="NVM-malloc"><a href="#NVM-malloc" class="headerlink" title="NVM_malloc"></a>NVM_malloc</h1><ul>
<li><p>How to get memory from system</p>
<ul>
<li>Using <code>mmap</code> to get memory region from application’s virtual memory</li>
<li>Instead of creating one giant file, multiple files are mapped into contiguous, anonymous mmap space</li>
<li>All translations are done by the MMU without kernel involvement or other software overhead (Bypass feature)</li>
</ul>
</li>
<li><p>Two-step allocation</p>
<ul>
<li>Reserve Data -&gt; (Prepare Data) -&gt; Activate Memory</li>
<li>Reserve: Get resource from heap memory region for using, recovered as “Free”</li>
<li>Activate Memory: Establish links from other objects, recovered as “In use” </li>
</ul>
</li>
<li><p>Faster execution</p>
<ul>
<li>Making DRAM as Cache to storing meta-data (VHeader: A volatile copy)</li>
<li>Reserve step can be executed in DRAM</li>
<li>64 B (cacheline-sized) headers ensure atomic flushes to NVRAM</li>
</ul>
</li>
</ul>
<pre><code>DRAM.       |  NVRAM                                 
VHeader. &lt;--|--&gt;  Header --&gt; Block
            |
</code></pre><h1 id="Pmem-a-k-a-NVML"><a href="#Pmem-a-k-a-NVML" class="headerlink" title="Pmem (a.k.a, NVML)"></a>Pmem (a.k.a, NVML)</h1><h1 id="Makalu"><a href="#Makalu" class="headerlink" title="Makalu"></a>Makalu</h1><h1 id="PAllocator"><a href="#PAllocator" class="headerlink" title="PAllocator"></a>PAllocator</h1>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/blog/blog/2017/09/18/Learning-About-Memory-Allocation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Teng Ma">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Teng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/09/18/Learning-About-Memory-Allocation/" itemprop="url">Learning About Memory Allocation</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-18T10:23:13+08:00">
                2017-09-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>Basic Posix Allocation API:</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> *<span class="title">malloc</span><span class="params">(	<span class="keyword">size_t</span> size)</span></span>;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">void</span> *<span class="title">calloc</span><span class="params">(	<span class="keyword">size_t</span> number,</span></span></div><div class="line"> 	<span class="keyword">size_t</span> size);</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">posix_memalign</span><span class="params">(	<span class="keyword">void</span> **ptr,</span></span></div><div class="line"> 	<span class="keyword">size_t</span> alignment,</div><div class="line"> 	<span class="keyword">size_t</span> size);</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">void</span> *<span class="title">aligned_alloc</span><span class="params">(	<span class="keyword">size_t</span> alignment,</span></span></div><div class="line"> 	<span class="keyword">size_t</span> size);</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">void</span> *<span class="title">realloc</span><span class="params">(	<span class="keyword">void</span> *ptr,</span></span></div><div class="line"> 	<span class="keyword">size_t</span> size);</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">free</span><span class="params">(	<span class="keyword">void</span> *ptr)</span></span>;</div></pre></td></tr></table></figure>
<ul>
<li><p><a href="http://blog.csdn.net/horkychen/article/details/35735103" target="_blank" rel="external">Memory Allocator Introduction (In Chinese)</a></p>
</li>
<li><p><a href="http://www.thinkingyu.com/articles/jemalloc/" target="_blank" rel="external">Jemalloc Learning (In Chinese)</a></p>
</li>
<li><p>Catalog</p>
<ul>
<li>PtMalloc (a.k.a, glibc malloc)</li>
<li><a href="http://goog-perftools.sourceforge.net/doc/tcmalloc.html" target="_blank" rel="external">TCMalloc (By Google)</a></li>
<li><a href="http://jemalloc.net/jemalloc.3.html" target="_blank" rel="external">JeMalloc (By FreeBSD)</a></li>
<li><a href="https://www.hoard.org/" target="_blank" rel="external">Hoard (By MIT)</a></li>
<li>To be continued.</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/blog/blog/2017/08/31/Paper-Reading-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Teng Ma">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Teng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/08/31/Paper-Reading-3/" itemprop="url">Paper Reading (3)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-31T19:52:20+08:00">
                2017-08-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Data-Tiering-in-Heterogeneous-Memory-Systems"><a href="#Data-Tiering-in-Heterogeneous-Memory-Systems" class="headerlink" title="Data Tiering in Heterogeneous Memory Systems"></a>Data Tiering in Heterogeneous Memory Systems</h1><ul>
<li><p>Heterogeneous memory architectures coupling DRAM with high capacity, low cost, but also lower performance NVM. couple NVM with a smaller amount of DRAM as cache.</p>
</li>
<li><p>Contributions:</p>
<ol>
<li>high performance -&gt; placing some applications data structures in small DRAM</li>
<li>different memory access patterns (sequential, random, pointer chasing)<ul>
<li>pointer chasing: every operation will occur a cache miss when traveling a list</li>
</ul>
</li>
<li>X-mem -&gt; map objects to data structures<ul>
<li>automatically placing data-structures in appropriate memory types</li>
</ul>
</li>
<li>According access pattern and automates the task of mapping memory regions of that data structure to DRAM or NVM to optimize performance </li>
</ol>
</li>
<li><p>Design (features)</p>
<ol>
<li>Using a unique tag (Hash, Tree, Buffer) for each data structures</li>
<li>Binding NVM and DRAM to NUMA node</li>
<li>Select the Solution Type</li>
</ol>
</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>Dependent</th>
<th>Independent</th>
</tr>
</thead>
<tbody>
<tr>
<td>Sequential</td>
<td>NA</td>
<td>Streaming</td>
</tr>
<tr>
<td>Non-sequential</td>
<td>Pointer chasing</td>
<td>Random</td>
</tr>
</tbody>
</table>
<h1 id="A-Write-friendly-Hashing-Scheme-for-Non-volatile-Memory-Systems"><a href="#A-Write-friendly-Hashing-Scheme-for-Non-volatile-Memory-Systems" class="headerlink" title="A Write-friendly Hashing Scheme for Non-volatile Memory Systems"></a>A Write-friendly Hashing Scheme for Non-volatile Memory Systems</h1><ul>
<li><p>This is a naive paper, and the idea is trivial</p>
</li>
<li><p>This paper introduces a newly hash scheme, which reduce frequency of write operation in NVM</p>
</li>
<li><p>Existing Hashing Schemes:</p>
<ul>
<li>Chained Hash</li>
<li>Linear Hash</li>
<li>2-choice Hash</li>
<li>Cuckoo Hash</li>
</ul>
</li>
<li><p>Hash Scheme Structure</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">| |---| |---| |---| |---| |---| |---| |---| |   Layer-1</div><div class="line">  \   /       \   /       \   /       \   /</div><div class="line">   | |---------| |---------| |---------| |      Layer-2</div><div class="line">      \       /               \       /</div><div class="line">       \     /                 \     /</div><div class="line">         | |                     | |            Layer-3</div><div class="line"></div><div class="line">                  ...........                   Layer-L</div></pre></td></tr></table></figure>
<ul>
<li>every two nearly table items share a item in next layer</li>
<li>cache coherence</li>
<li>remove some levels in the bottom -&gt; shortening finding path</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/blog/blog/2017/08/31/Atomic-SpinLock-Mutex-Thread-Lock-Which-Is-The-Fastest-One/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Teng Ma">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Teng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/08/31/Atomic-SpinLock-Mutex-Thread-Lock-Which-Is-The-Fastest-One/" itemprop="url">Atomic, SpinLock, Mutex, Thread_Lock, Which Is The Fastest One?</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-31T19:38:27+08:00">
                2017-08-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>When we write a concurrent program, we have various methods to guarantee our program is linearizable and serializable, which means different threads will write or read a area of same memory or variable sequentially. But the efficiency of these methods is very different. Next I will introduce four methods: <code>atomic, spin lock, mutex and thread lock</code>, and compare these four methods to analysis which one is the fastest one (maybe is not the best one).</p>
<p>I use <code>time ./exec</code> to estimate the running time of programs.</p>
<h1 id="Atomic"><a href="#Atomic" class="headerlink" title="Atomic"></a>Atomic</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;future&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;thread&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;atomic&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line">atomic&lt;<span class="keyword">int</span>&gt; counter(<span class="number">0</span>);</div><div class="line"><span class="keyword">int</span> thread_num = <span class="number">2</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> limit_iter = <span class="number">10000000</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit_iter; i ++ ) &#123;</div><div class="line">		counter ++;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	thread a[thread_num];</div><div class="line"></div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; thread_num; i ++ ) &#123;</div><div class="line">	 	a[i] = thread(f);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; thread_num; i ++ ) &#123;</div><div class="line">	 	a[i].join();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="built_in">cout</span> &lt;&lt; counter &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Spin-Lock"><a href="#Spin-Lock" class="headerlink" title="Spin Lock"></a>Spin Lock</h1><p>I use c++ atomic variable to implement a spin lock likely structure, because <code>C++11</code> doesn’t provide a implementation of spin lock.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;future&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;thread&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;atomic&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line">atomic_flag locked = ATOMIC_FLAG_INIT;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">lock</span><span class="params">()</span> </span>&#123;</div><div class="line"> 	locked.test_and_set(<span class="built_in">std</span>::memory_order_acquire);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">unlock</span><span class="params">()</span> </span>&#123;</div><div class="line"> 	locked.clear(memory_order_acquire);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">counter</span><span class="params">(<span class="number">0</span>)</span></span>;</div><div class="line"><span class="keyword">int</span> thread_num = <span class="number">2</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> limit_iter = <span class="number">10000000</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit_iter; i ++ ) &#123;</div><div class="line">		lock();</div><div class="line">		counter ++;</div><div class="line">		unlock();</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	thread a[thread_num];</div><div class="line"></div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; thread_num; i ++ ) &#123;</div><div class="line">	 	a[i] = thread(f);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; thread_num; i ++ ) &#123;</div><div class="line">	 	a[i].join();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="built_in">cout</span> &lt;&lt; counter &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Mutex"><a href="#Mutex" class="headerlink" title="Mutex"></a>Mutex</h1><p>I use <code>c++11</code> mutex, not the mutex in <code>unix</code> API, to doing test.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;future&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;thread&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;atomic&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">counter</span><span class="params">(<span class="number">0</span>)</span></span>;</div><div class="line"></div><div class="line">mutex mu;</div><div class="line"></div><div class="line"><span class="keyword">int</span> thread_num = <span class="number">2</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> limit_iter = <span class="number">10000000</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit_iter; i ++ ) &#123;</div><div class="line"><span class="comment">//		lock_guard&lt;mutex&gt; lock(mu); // Or this line can provide the same effect</span></div><div class="line">		mu.lock();</div><div class="line">		counter ++;</div><div class="line">		mu.unlock();</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	thread a[thread_num];</div><div class="line"></div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; thread_num; i ++ ) &#123;</div><div class="line">	 	a[i] = thread(f);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; thread_num; i ++ ) &#123;</div><div class="line">	 	a[i].join();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="built_in">cout</span> &lt;&lt; counter &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="thread-lock"><a href="#thread-lock" class="headerlink" title="thread lock"></a>thread lock</h1><p>There is not existing a thread lock method in C++11, so I use <code>pthread_mutex_lock</code> and <code>pthread_mutex_unlock</code> in pthread lib to instead. But thread library in C++11 is based on pthread, so I think this is a equally and right testing.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;future&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;thread&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;atomic&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;pthread.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line">atomic&lt;<span class="keyword">int</span>&gt; counter(<span class="number">0</span>);</div><div class="line"><span class="keyword">int</span> thread_num = <span class="number">2</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> limit_iter = <span class="number">10000000</span>;</div><div class="line"></div><div class="line"><span class="keyword">pthread_mutex_t</span> locked;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit_iter; i ++ ) &#123;</div><div class="line">		pthread_mutex_lock(&amp;locked);	</div><div class="line"></div><div class="line">		counter ++;</div><div class="line"></div><div class="line">		pthread_mutex_unlock(&amp;locked);	</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line"> 	pthread_mutex_init(&amp;locked, <span class="literal">NULL</span>);</div><div class="line"></div><div class="line">	thread a[thread_num];</div><div class="line"></div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; thread_num; i ++ ) &#123;</div><div class="line">	 	a[i] = thread(f);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; thread_num; i ++ ) &#123;</div><div class="line">	 	a[i].join();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="built_in">cout</span> &lt;&lt; counter &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="evaluation"><a href="#evaluation" class="headerlink" title="evaluation"></a>evaluation</h1><p>I use <code>two</code> threads in one process, and every thread do 10M times of increment operations.</p>
<table>
<thead>
<tr>
<th>methods</th>
<th>time</th>
</tr>
</thead>
<tbody>
<tr>
<td>without any lock</td>
<td>0.24s</td>
</tr>
<tr>
<td>atomic</td>
<td>1.08s</td>
</tr>
<tr>
<td>spin lock</td>
<td>2.90s</td>
</tr>
<tr>
<td>mutex</td>
<td>5.82s</td>
</tr>
<tr>
<td>thread lock</td>
<td>6.81s</td>
</tr>
</tbody>
</table>
<ul>
<li><p>In a nutshell, making variable becoming atomic is the fastest one.</p>
</li>
<li><p>This is the <a href="https://github.com/stmatengss/learning-creating_by_cpp/tree/master/compare_lock" target="_blank" rel="external">link</a> of all codes.</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/blog/blog/2017/08/30/All-Kinds-of-Allocations/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Teng Ma">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Teng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/08/30/All-Kinds-of-Allocations/" itemprop="url">All Kinds of Allocations</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-30T10:22:52+08:00">
                2017-08-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><p>memalign</p>
</li>
<li><p>jemalloc</p>
</li>
<li><p>valloc</p>
</li>
<li><p>malloc / realloc / calloc</p>
</li>
<li><p>kmalloc / vmalloc (kernel level)</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/blog/blog/2017/08/21/Some-Useful-Technologies-About-RDMA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Teng Ma">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Teng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/08/21/Some-Useful-Technologies-About-RDMA/" itemprop="url">Some Useful Technologies About RDMA (1)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-21T14:44:30+08:00">
                2017-08-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>SGL (scatter / gather list)</li>
</ul>
<p>An array of S/G elements which exists in a WR that according to the used opcode either collects data from multiple buffers and sends them as a single stream or takes a single stream and breaks it down to numerous buffers</p>
<ul>
<li><p>Without Signal</p>
</li>
<li><p>Batch Multi-request to One</p>
</li>
<li><p>Fence</p>
</li>
</ul>
<!-- * Immediate Number -->
<!-- * Shared Completion Queue -->
<!-- * Inline Small Messages -->
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/blog/blog/2017/08/21/Paper-Reading-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Teng Ma">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Teng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/08/21/Paper-Reading-2/" itemprop="url">Paper Reading (2)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-21T14:26:06+08:00">
                2017-08-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="NOVA"><a href="#NOVA" class="headerlink" title="NOVA"></a>NOVA</h1><ul>
<li><p>Conclusion:<br>Adapts conventional log-structured file system techniques to exploit the fast random access that NVMs provide.</p>
<ul>
<li>separate logs for each inode to improve concurrency</li>
<li>stores file data outside the log to minimize log size and reduce garbage collection costs</li>
<li>based on hardware-based NVMM emulator</li>
</ul>
</li>
<li><p>NOVA’s logs provide metadata, data, and mmap atomicity and focus on simplicity and reliability, keeping complex metadata structures in DRAM to accelerate lookup operations</p>
</li>
<li><p>Contributes:</p>
<ol>
<li>It extends existing log-structured file system techniques to exploit the characteristics of hybrid memory systems. </li>
<li>It describes atomic mmap, a simplified interface for exposing NVMM directly to applications with a strong consistency guarantee. </li>
<li>It demonstrates that NOVA outperforms existing journaling, shadow paging, and log-structured file systems running on hybrid memory systems. </li>
<li>It shows that NOVA provides these benefits across a range of proposed NVMM technologies.</li>
</ol>
</li>
<li><p>Challenges:</p>
<ol>
<li>Performance: NVMM has lower latency -&gt; Direct Access (DAX) avoids extra copy between NVMM and DRAM.</li>
<li>Write Reordering: cache hierarchies (modern processor) -&gt; reorder store operations -&gt; do not guarantee when update will reach NVMMs.<br>explicitly flushing caches and issuing memory barriers (fence) -&gt; clflush instrument.</li>
<li>Atomicity: POSIX-style file system require operations to be atomic (e.g. Rename) -&gt; Disk only provides 8-byte atomic operation<ul>
<li>three technologies to apply atomic: Journaling, Shadow Paging, Log-structuring</li>
</ul>
</li>
</ol>
</li>
<li><p>Three observations:</p>
<ol>
<li>Data structure which support fast search is hard to implement in NVMM</li>
<li>Complexity if cleaning logs stems is unnecessary due to cheaper random access</li>
<li>Using single log limits concurrency</li>
</ol>
</li>
<li><p>Design Decisions:</p>
<ol>
<li>Keep logs in NVMM and indexes in DRAM (radix tree)<ul>
<li>persistent log is simple and efficient</li>
<li>volatile tree structure has no consistency overhead</li>
</ul>
</li>
<li>Give each inode its own log: Allow concurrent updates across files without sync (high concurrency/scalability) <ul>
<li>Per-CPU NVMM free list, journal and inode table</li>
<li>concurrent transactions and (de)allocation</li>
</ul>
</li>
<li>Use logging and lightweight journaling for complex atomic updates, making sure atomic<ul>
<li>append data to logs</li>
<li>update the log tail to commit the updates (avoid duplicate writes)</li>
</ul>
</li>
<li><p>Implement the log as a singly linked list (4 KB NVMM pages)</p>
<ul>
<li>allocate log space is easy</li>
<li>perform log cleaning at fine grained (Page level)</li>
<li>reclaiming log pages require a few pointer assignments</li>
</ul>
</li>
<li><p>Do not log file data</p>
</li>
<li>Copy-on-write for file data<ul>
<li>Log only contains meta-data</li>
<li>Log is short</li>
</ul>
</li>
</ol>
</li>
<li><p>Fast garbage collection</p>
<ul>
<li>Log is a linked list and only contains meta-data -&gt; fast GC deletes dead log pages from list (No copying)</li>
<li>Two different techs:<ol>
<li>Fast GC: deleting dead log page from linked list</li>
<li>Through GC: valid log &lt; 50% -&gt; format a new log and atomically replace the old one -&gt; only copy meta-data</li>
</ol>
</li>
</ul>
</li>
</ul>
<h1 id="NV-Tree"><a href="#NV-Tree" class="headerlink" title="NV-Tree"></a>NV-Tree</h1><ul>
<li><p>A consistent and cache-optimized B+Tree with reducing CPU cacheline flush</p>
</li>
<li><p>Motivations:</p>
<ul>
<li>Keeping consistency causes a high amplification of the CPU cacheline invalidation and flush with increasing cache misses significantly</li>
<li>the consistency cost due to flush mostly comes from flushing shifted entries in order to keep LN sorted</li>
<li>not all the data needs to be consistent to keep the entire data structure consistent</li>
</ul>
</li>
<li><p>Overview:</p>
<ul>
<li>Design<ol>
<li>Selectively Enforce Data Consistency</li>
<li>Keep Entries in LN Unsorted</li>
<li>Organizing IN in Cache-optimized Format</li>
</ol>
</li>
<li><em>IN</em> - <em>PLN</em> - LN</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/blog/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/blog/">1</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/blog/page/5/">5</a><a class="extend next" rel="next" href="/blog/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/blog/images/avatar.gif"
               alt="Teng Ma" />
          <p class="site-author-name" itemprop="name">Teng Ma</p>
           
              <p class="site-description motion-element" itemprop="description">...</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/blog/archives/">
                <span class="site-state-item-count">47</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/blog/tags/index.html">
                <span class="site-state-item-count">31</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/stmatengss" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://stackoverflow.com/users/5955640/stmatengss" target="_blank" title="Stackoverflow">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Stackoverflow
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.linkedin.com/in/ma-teng-69a0a8115/" target="_blank" title="Linkedin">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Linkedin
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Teng Ma</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/blog/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/blog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/blog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/blog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/blog/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/blog/js/src/motion.js?v=5.1.1"></script>



  
  

  
    <script type="text/javascript" src="/blog/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/blog/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/blog/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  

  

  

  

</body>
</html>
